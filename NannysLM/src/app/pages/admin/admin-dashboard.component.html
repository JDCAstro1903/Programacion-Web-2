<div class="admin-layout">
  <!-- Header Genérico -->
  <app-header 
    [config]="headerConfig"
    (onLogout)="onHeaderLogout()"
    (onProfileClick)="onHeaderProfileClick()">
  </app-header>

  <!-- Layout principal -->
  <div class="main-layout">
    <!-- Sidebar Reutilizable -->
    <app-sidebar 
      [config]="sidebarConfig" 
      [currentView]="currentView"
      (onViewChange)="onViewChange($event)">
    </app-sidebar>

    <!-- Contenido principal -->
    <main class="main-content">
      <!-- Vista Dashboard -->
      <div *ngIf="currentView === 'dashboard'" class="dashboard-view">
        <div class="content-header">
          <h2>Dashboard</h2>
          <p>Panel de control principal para la gestión de NannysLM</p>
        </div>
        
        <!-- Métricas principales con diseño moderno -->
        <div class="metrics-grid">
          <!-- Tarjeta de Nannys -->
          <div class="metric-card nannys-metric">
            <div class="metric-background">
              <div class="metric-icon">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z" fill="currentColor"/>
                </svg>
              </div>
              <div class="metric-content">
                <h3>Nannys Disponibles</h3>
                <div class="metric-number">{{ (dashboardStats && dashboardStats.nannys) ? dashboardStats.nannys.active : 0 }}</div>
              </div>
            </div>
            <div class="metric-actions">
              <button class="quick-action-btn" (click)="setCurrentView('nannys')">
                Ver Todas
              </button>
            </div>
          </div>

          <!-- Tarjeta de Clientes Verificados -->
          <div class="metric-card clients-metric">
            <div class="metric-background">
              <div class="metric-icon">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M9 12L11 14L15 10M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </div>
              <div class="metric-content">
                <h3>Clientes Verificados</h3>
                <div class="metric-number">{{ (dashboardStats && dashboardStats.clients) ? dashboardStats.clients.verified : 0 }}</div>
              </div>
            </div>
            <div class="metric-actions">
              <button class="quick-action-btn" (click)="setCurrentView('clients')">
                Gestionar
              </button>
            </div>
          </div>

          <!-- Tarjeta de Ingresos -->
          <div class="metric-card revenue-metric">
            <div class="metric-background">
              <div class="metric-icon">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M11.8 10.9c-2.27-.59-3-1.2-3-2.15 0-1.09 1.01-1.85 2.7-1.85 1.78 0 2.44.85 2.5 2.1h2.21c-.07-1.72-1.12-3.3-3.21-3.81V3h-3v2.16c-1.94.42-3.5 1.68-3.5 3.61 0 2.31 1.91 3.46 4.7 4.13 2.5.6 3 1.48 3 2.41 0 .69-.49 1.79-2.7 1.79-2.06 0-2.87-.92-2.98-2.1h-2.2c.12 2.19 1.76 3.42 3.68 3.83V21h3v-2.15c1.95-.37 3.5-1.5 3.5-3.55 0-2.84-2.43-3.81-4.7-4.4z" fill="currentColor"/>
                </svg>
              </div>
              <div class="metric-content">
                <h3>Ingresos del Mes</h3>
                <div class="metric-number">${{ getMonthlyRevenue().toLocaleString() }}</div>
              </div>
            </div>
            <div class="metric-actions">
              <button class="quick-action-btn" (click)="setCurrentView('payments')">
                Ver Reportes
              </button>
            </div>
          </div>

          <!-- Tarjeta de Datos Bancarios -->
          <div class="metric-card banking-metric">
            <div class="metric-background">
              <div class="metric-icon">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <rect x="1" y="4" width="22" height="16" rx="2" ry="2" stroke="currentColor" stroke-width="2" fill="none"/>
                  <line x1="1" y1="10" x2="23" y2="10" stroke="currentColor" stroke-width="2"/>
                </svg>
              </div>
              <div class="metric-content">
                <h3>Datos Bancarios</h3>
                <div class="metric-number">{{ datosBancarios.length }}</div>
                <div class="metric-detail">
                  <span class="trend-neutral">Cuentas configuradas</span>
                </div>
              </div>
            </div>
            <div class="metric-actions">
              <button class="quick-action-btn" (click)="setCurrentView('datos-bancarios')">
                Gestionar
              </button>
            </div>
          </div>
        </div>

        <!-- Sección de actividad reciente -->
        <div class="activity-section">
          <div class="section-header">
            <h3>Actividad Reciente</h3>
          </div>
          
          <div class="activity-grid">
            <!-- Panel de actividad de nannys -->
            <div class="activity-panel">
              <div class="panel-header">
                <div class="panel-icon nannys-color">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z" fill="currentColor"/>
                  </svg>
                </div>
                <h4>Nannys Activas</h4>
              </div>
              <div class="activity-content">
                <div *ngFor="let nanny of getActiveNannysSlice()" class="activity-item">
                  <div class="activity-info">
                    <span class="activity-name">{{ nanny.first_name }} {{ nanny.last_name }}</span>
                    <span class="activity-detail">{{ nanny.rating_average.toFixed(1) || '0.0' }}⭐ • €{{ nanny.hourly_rate }}/h</span>
                  </div>
                  <div class="activity-status status-active">Activa</div>
                </div>
              </div>
            </div>

            <!-- Panel de pagos recientes -->
            <div class="activity-panel">
              <div class="panel-header">
                <div class="panel-icon payments-color">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M11.8 10.9c-2.27-.59-3-1.2-3-2.15 0-1.09 1.01-1.85 2.7-1.85 1.78 0 2.44.85 2.5 2.1h2.21c-.07-1.72-1.12-3.3-3.21-3.81V3h-3v2.16c-1.94.42-3.5 1.68-3.5 3.61 0 2.31 1.91 3.46 4.7 4.13 2.5.6 3 1.48 3 2.41 0 .69-.49 1.79-2.7 1.79-2.06 0-2.87-.92-2.98-2.1h-2.2c.12 2.19 1.76 3.42 3.68 3.83V21h3v-2.15c1.95-.37 3.5-1.5 3.5-3.55 0-2.84-2.43-3.81-4.7-4.4z" fill="currentColor"/>
                  </svg>
                </div>
                <h4>Pagos Recientes</h4>
              </div>
              <div class="activity-content">
                <div *ngFor="let payment of getRecentPayments()" class="activity-item">
                  <div class="activity-info">
                    <span class="activity-name">{{ payment.clientName }}</span>
                    <span class="activity-detail">{{ payment.date }} • {{ payment.hours }}h</span>
                  </div>
                  <div class="activity-amount">${{ payment.amount }}</div>
                </div>
              </div>
            </div>

            <!-- Panel de clientes no verificados -->
            <div class="activity-panel">
              <div class="panel-header">
                <div class="panel-icon clients-color">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z" fill="currentColor"/>
                  </svg>
                </div>
                <h4>Clientes Pendientes</h4>
              </div>
              <div class="activity-content">
                <div *ngFor="let client of getUnverifiedClientsSlice()" class="activity-item">
                  <div class="activity-info">
                    <span class="activity-name">{{ client.name }}</span>
                    <span class="activity-detail">{{ formatDate(client.createdAt) }}</span>
                  </div>
                  <div class="activity-status status-pending">Pendiente</div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Sección de acciones rápidas -->
        <div class="quick-actions-section">
          <div class="section-header">
            <h3>Acciones Rápidas</h3>
            <p>Herramientas de gestión frecuentes</p>
          </div>
          
          <div class="quick-actions-grid">
            <button class="quick-action-card" (click)="openBankDetailsModal()">
              <div class="action-icon banking">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <rect x="1" y="4" width="22" height="16" rx="2" ry="2" stroke="currentColor" stroke-width="2" fill="none"/>
                  <line x1="1" y1="10" x2="23" y2="10" stroke="currentColor" stroke-width="2"/>
                </svg>
              </div>
              <div class="action-content">
                <h4>Agregar Datos Bancarios</h4>
                <p>Configurar información bancaria para nannys</p>
              </div>
            </button>

            <button class="quick-action-card" (click)="setCurrentView('clients')">
              <div class="action-icon clients">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M9 12L11 14L15 10M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </div>
              <div class="action-content">
                <h4>Verificar Clientes</h4>
                <p>Revisar y aprobar nuevos registros</p>
              </div>
            </button>

            <button class="quick-action-card" (click)="setCurrentView('payments')">
              <div class="action-icon payments">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M9 11H7v9h2v-9zm4 0h-2v9h2v-9zm4 0h-2v9h2v-9zm2-7v2H4v2h1v13a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V8h1V6H8V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2h4z" fill="currentColor"/>
                </svg>
              </div>
              <div class="action-content">
                <h4>Procesar Pagos</h4>
                <p>Revisar y validar transacciones pendientes</p>
              </div>
            </button>

            <button class="quick-action-card" (click)="setCurrentView('nannys')">
              <div class="action-icon nannys">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z" fill="currentColor"/>
                </svg>
              </div>
              <div class="action-content">
                <h4>Gestionar Nannys</h4>
                <p>Administrar perfiles y disponibilidad</p>
              </div>
            </button>
          </div>
        </div>
      </div>


      <!-- Vista Nannys -->
      <div *ngIf="currentView === 'nannys'" class="nannys-view">
        <div class="content-header">
          <div class="header-content">
            <h2>Gestión de Nannys</h2>
            <p>Administra las cuidadoras registradas en la plataforma</p>
          </div>
          <button class="add-nanny-btn" (click)="openAddNannyModal()">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M12 5v14m-7-7h14" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </svg>
            Agregar Nanny
          </button>
        </div>
        
        <!-- Estadísticas rápidas -->
        <div class="nannys-stats">
          <div class="stat-item">
            <div class="stat-number">{{ getNannyCount('active') }}</div>
            <div class="stat-label">Activas</div>
          </div>
          <div class="stat-item">
            <div class="stat-number">{{ getNannyCount('suspended') }}</div>
            <div class="stat-label">Suspendidas</div>
          </div>
          <div class="stat-item">
            <div class="stat-number">{{ getNannyCount('inactive') }}</div>
            <div class="stat-label">Inactivas</div>
          </div>
          <div class="stat-item">
            <div class="stat-number">{{ getTotalNannys() }}</div>
            <div class="stat-label">Total</div>
          </div>
        </div>
        
        <!-- Filtros de estado modernos -->
        <div class="modern-filter-tabs">
          <button 
            (click)="setNannyFilter('active')" 
            class="modern-filter-tab active-tab"
            [class.active]="nannyFilter === 'active'">
            <div class="tab-indicator"></div>
            <div class="tab-content">
              <div class="tab-icon">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M9 12L11 14L15 10M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </div>
              <span class="tab-text">Activas</span>
              <span class="tab-count">{{ getNannyCount('active') }}</span>
            </div>
          </button>
          
          <button 
            (click)="setNannyFilter('suspended')" 
            class="modern-filter-tab suspended-tab"
            [class.active]="nannyFilter === 'suspended'">
            <div class="tab-indicator"></div>
            <div class="tab-content">
              <div class="tab-icon">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <rect x="3" y="4" width="18" height="18" rx="2" ry="2" stroke="currentColor" stroke-width="2"/>
                  <line x1="16" y1="2" x2="16" y2="6" stroke="currentColor" stroke-width="2"/>
                  <line x1="8" y1="2" x2="8" y2="6" stroke="currentColor" stroke-width="2"/>
                  <line x1="3" y1="10" x2="21" y2="10" stroke="currentColor" stroke-width="2"/>
                </svg>
              </div>
              <span class="tab-text">Suspendidas</span>
              <span class="tab-count">{{ getNannyCount('suspended') }}</span>
            </div>
          </button>
          
          <button 
            (click)="setNannyFilter('inactive')" 
            class="modern-filter-tab inactive-tab"
            [class.active]="nannyFilter === 'inactive'">
            <div class="tab-indicator"></div>
            <div class="tab-content">
              <div class="tab-icon">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                  <line x1="15" y1="9" x2="9" y2="15" stroke="currentColor" stroke-width="2"/>
                  <line x1="9" y1="9" x2="15" y2="15" stroke="currentColor" stroke-width="2"/>
                </svg>
              </div>
              <span class="tab-text">Inactivas</span>
              <span class="tab-count">{{ getNannyCount('inactive') }}</span>
            </div>
          </button>
        </div>

        <!-- Lista de Nannys modernizada -->
        <div class="modern-nannys-grid">
          <div *ngFor="let nanny of getCurrentNannys()" class="modern-nanny-card">
            <!-- Header de la tarjeta -->
            <div class="nanny-card-header">
              <div class="nanny-profile">
                <div class="nanny-avatar-container">
                  <div class="nanny-avatar">
                    <div class="avatar-image">
                      {{ ((nanny.first_name || 'N')[0] || 'N') + ((nanny.last_name || 'A')[0] || 'A') }}
                    </div>
                  </div>
                  <div class="nanny-status-indicator" [class]="'status-' + getStatusFromData(nanny)"></div>
                </div>
                <div class="nanny-basic-info">
                  <div class="name-with-status">
                    <h3 class="nanny-name">{{ nanny.first_name || 'Sin nombre' }} {{ nanny.last_name || '' }}</h3>
                    <span class="status-text" [class]="'status-' + getStatusFromData(nanny)">
                      {{ getStatusText(getStatusFromData(nanny)) }}
                    </span>
                  </div>
                  <div class="nanny-rating">
                    <div class="stars">
                      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 2L15.09 8.26L22 9L17 14L18.18 21L12 17.77L5.82 21L7 14L2 9L8.91 8.26L12 2Z" fill="#fbbf24"/>
                      </svg>
                      <span class="rating-value">{{ (nanny.rating_average || 0).toFixed(1) }}</span>
                    </div>
                    <span class="experience-text">{{ nanny.services_completed || 0 }} servicios</span>
                  </div>
                </div>
              </div>
              <div class="nanny-rate-info">
                <div class="hourly-rate">
                  <span class="rate-amount">€{{ nanny.hourly_rate || 0 }}</span>
                  <span class="rate-period">/hora</span>
                </div>
              </div>
            </div>

            <!-- Cuerpo de la tarjeta -->
            <div class="nanny-card-body">
              <div class="nanny-location">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M21 10C21 17 12 23 12 23S3 17 3 10C3 5.02944 7.02944 1 12 1C16.9706 1 21 5.02944 21 10Z" stroke="currentColor" stroke-width="2"/>
                  <circle cx="12" cy="10" r="3" stroke="currentColor" stroke-width="2"/>
                </svg>
                <span>{{ nanny.address || 'No especificada' }}</span>
              </div>
              
              <div class="nanny-description" *ngIf="nanny.description">
                <p>{{ nanny.description.length > 100 ? (nanny.description | slice:0:100) + '...' : nanny.description }}</p>
              </div>
            </div>

            <!-- Footer de la tarjeta -->
            <div class="nanny-card-footer">
              <button class="nanny-action-btn secondary" (click)="viewNannyProfile(nanny.id)">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M1 12S5 4 12 4S23 12 23 12S19 20 12 20S1 12 1 12Z" stroke="currentColor" stroke-width="2"/>
                  <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2"/>
                </svg>
                Ver Perfil
              </button>
              <button class="nanny-action-btn primary" (click)="contactNanny(nanny.id)">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M22 2L11 13" stroke="currentColor" stroke-width="2"/>
                  <path d="M22 2L15 22L11 13L2 9L22 2Z" stroke="currentColor" stroke-width="2"/>
                </svg>
                Contactar
              </button>
            </div>
          </div>
          
          <!-- Estado vacío si no hay nannys en la categoría -->
          <div *ngIf="getCurrentNannys().length === 0" class="empty-state-modern">
            <div class="empty-illustration">
              <svg width="80" height="80" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M12 12C14.2091 12 16 10.2091 16 8C16 5.79086 14.2091 4 12 4C9.79086 4 8 5.79086 8 8C8 10.2091 9.79086 12 12 12Z" stroke="#e2e8f0" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M20 21V19C20 16.7909 18.2091 15 16 15H8C5.79086 15 4 16.7909 4 19V21" stroke="#e2e8f0" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </div>
            <h3>No hay nannys {{ getFilterLabel() }}</h3>
            <p>No se encontraron cuidadoras en esta categoría.</p>
            <button class="add-first-nanny-btn" (click)="openAddNannyModal()">
              Agregar Primera Nanny
            </button>
          </div>
        </div>
      </div>

      <!-- Vista Clientes -->
      <div *ngIf="currentView === 'clients'" class="clients-view">
        <div class="content-header">
          <h2>Gestión de Clientes</h2>
          <p>Administra y supervisa a todos los clientes de la plataforma</p>
        </div>
        
        <!-- Estadísticas rápidas -->
        <div class="clients-stats">
          <div class="stat-card verified">
            <div class="stat-icon">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M9 12L11 14L15 10M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </div>
            <div class="stat-content">
              <h3>{{ getClientCount('verified') }}</h3>
              <p>Clientes Verificados</p>
            </div>
          </div>
          
          <div class="stat-card pending">
            <div class="stat-icon">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                <polyline points="12,6 12,12 16,14" stroke="currentColor" stroke-width="2"/>
              </svg>
            </div>
            <div class="stat-content">
              <h3>{{ getClientCount('unverified') }}</h3>
              <p>Pendientes de Verificación</p>
            </div>
          </div>
          
          <div class="stat-card total">
            <div class="stat-icon">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M17 21V19C17 17.9391 16.5786 16.9217 15.8284 16.1716C15.0783 15.4214 14.0609 15 13 15H5C3.93913 15 2.92172 15.4214 2.17157 16.1716C1.42143 16.9217 1 17.9391 1 19V21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <circle cx="9" cy="7" r="4" stroke="currentColor" stroke-width="2"/>
                <path d="M23 21V19C23 18.1645 22.7155 17.3541 22.2045 16.7006C21.6935 16.047 20.9877 15.5856 20.194 15.3893" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M16 3.13C16.8604 3.35031 17.623 3.85071 18.1676 4.55232C18.7122 5.25392 19.0078 6.11683 19.0078 7.005C19.0078 7.89317 18.7122 8.75608 18.1676 9.45768C17.623 10.1593 16.8604 10.6597 16 10.88" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </div>
            <div class="stat-content">
              <h3>{{ clientsData.length }}</h3>
              <p>Total de Clientes</p>
            </div>
          </div>
        </div>

        <!-- Filtros de estado modernos -->
        <div class="modern-filter-section">
          <div class="filter-header">
            <h3>Filtrar Clientes</h3>
          </div>
          
          <div class="modern-filter-tabs">
            <button 
              (click)="setClientFilter('all')" 
              class="modern-filter-tab"
              [class.active]="clientFilter === 'all'">
              <div class="filter-tab-content">
                <div class="tab-icon primary">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2M9 11a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM23 21v-2a4 4 0 0 0-3-3.87M16 3.13a4 4 0 0 1 0 7.75" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </div>
                <div class="tab-info">
                  <span class="tab-title">Todos</span>
                  <span class="tab-count">{{ getClientCount('all') }}</span>
                </div>
              </div>
            </button>

            <button 
              (click)="setClientFilter('verified')" 
              class="modern-filter-tab"
              [class.active]="clientFilter === 'verified'">
              <div class="filter-tab-content">
                <div class="tab-icon verified">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M9 12L11 14L15 10M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </div>
                <div class="tab-info">
                  <span class="tab-title">Verificados</span>
                  <span class="tab-count">{{ getClientCount('verified') }}</span>
                </div>
              </div>
            </button>
            
            <button 
              (click)="setClientFilter('unverified')" 
              class="modern-filter-tab"
              [class.active]="clientFilter === 'unverified'">
              <div class="filter-tab-content">
                <div class="tab-icon pending">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                    <polyline points="12,6 12,12 16,14" stroke="currentColor" stroke-width="2"/>
                  </svg>
                </div>
                <div class="tab-info">
                  <span class="tab-title">Pendientes</span>
                  <span class="tab-count">{{ getClientCount('unverified') }}</span>
                </div>
              </div>
            </button>
          </div>
        </div>

        <!-- Grid moderno de clientes -->
        <div class="modern-clients-grid">
          <div *ngFor="let client of getCurrentClients()" class="modern-client-card">
            <!-- Header de la tarjeta -->
            <div class="client-card-header">
              <div class="client-profile">
                <div class="client-avatar-container">
                  <div class="client-avatar">
                    <!-- Mostrar foto de perfil si existe -->
                    <img 
                      *ngIf="client.profileImage" 
                      [src]="getProfileImageUrl(client.profileImage)" 
                      [alt]="client.name"
                      class="avatar-image-photo"
                      onerror="this.parentElement.querySelector('.avatar-image-fallback')?.style.removeProperty('display')">
                    
                    <!-- Si no hay foto, mostrar inicial con fondo de color -->
                    <div 
                      *ngIf="!client.profileImage" 
                      class="avatar-image avatar-image-fallback"
                      [ngStyle]="{'background-color': getAvatarColor(client.name)}">
                      {{ client.name.charAt(0).toUpperCase() }}
                    </div>
                  </div>
                  <div class="client-status-indicator" [class]="'status-' + getClientStatusFromData(client)"></div>
                </div>
                <div class="client-basic-info">
                  <div class="name-with-status">
                    <h3 class="client-name">{{ client.name }}</h3>
                    <span class="verification-badge" [class]="getClientStatusFromData(client)">
                      {{ getClientStatusText(getClientStatusFromData(client)) }}
                    </span>
                  </div>
                  <div class="client-contact">
                    <span class="email">{{ client.email }}</span>
                    <span class="phone">{{ client.phone }}</span>
                  </div>
                </div>
              </div>
            </div>

            <!-- Contenido de la tarjeta -->
            <div class="client-card-content">
              <div class="client-details">
                <div class="detail-item">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M21 10C21 17 12 23 12 23C12 23 3 17 3 10C3 7.61305 3.94821 5.32387 5.63604 3.63604C7.32387 1.94821 9.61305 1 12 1C14.3869 1 16.6761 1.94821 18.3639 3.63604C20.0518 5.32387 21 7.61305 21 10Z" stroke="currentColor" stroke-width="2"/>
                    <circle cx="12" cy="10" r="3" stroke="currentColor" stroke-width="2"/>
                  </svg>
                  <span>{{ client.address || 'No especificada' }}</span>
                </div>
                <div class="detail-item">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M20 21V19C20 17.9391 19.5786 16.9217 18.8284 16.1716C18.0783 15.4214 17.0609 15 16 15H8C6.93913 15 5.92172 15.4214 5.17157 16.1716C4.42143 16.9217 4 17.9391 4 19V21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <circle cx="12" cy="7" r="4" stroke="currentColor" stroke-width="2"/>
                  </svg>
                  <span>{{ client.numberOfChildren }} niño{{ client.numberOfChildren !== 1 ? 's' : '' }}</span>
                </div>
                <div class="detail-item">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2" stroke="currentColor" stroke-width="2"/>
                    <line x1="16" y1="2" x2="16" y2="6" stroke="currentColor" stroke-width="2"/>
                    <line x1="8" y1="2" x2="8" y2="6" stroke="currentColor" stroke-width="2"/>
                    <line x1="3" y1="10" x2="21" y2="10" stroke="currentColor" stroke-width="2"/>
                  </svg>
                  <span>Desde {{ formatDate(client.createdAt) }}</span>
                </div>
              </div>
            </div>

            <!-- Footer con acciones -->
            <div class="client-card-footer">
              <div class="client-stats">
                <div class="stat-item">
                  <span class="stat-label">Reservas</span>
                  <span class="stat-value">{{ getClientBookings(client.id) }}</span>
                </div>
                <div class="stat-item">
                  <span class="stat-label">Última actividad</span>
                  <span class="stat-value">{{ getLastActivity(client.id) }}</span>
                </div>
              </div>
              <div class="client-actions">
                <button class="action-btn secondary" title="Ver perfil" (click)="viewClientProfile(client)">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M1 12S5 4 12 4S23 12 23 12S19 20 12 20S1 12 1 12Z" stroke="currentColor" stroke-width="2"/>
                    <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2"/>
                  </svg>
                  Ver Perfil
                </button>
                
                <!-- Botón para verificar documentos (solo si el cliente tiene documentos) -->
                <button 
                  *ngIf="client.identification_document && getClientStatusFromData(client) === 'unverified'" 
                  class="action-btn verify-docs" 
                  title="Verificar documentos"
                  (click)="openVerifyDocumentModal(client)">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z" stroke="currentColor" stroke-width="2"/>
                    <polyline points="13,2 13,9 20,9" stroke="currentColor" stroke-width="2"/>
                    <path d="M9 13L11 15L15 11" stroke="currentColor" stroke-width="2"/>
                  </svg>
                  Verificar Docs
                </button>
                
                <button 
                  *ngIf="!client.identification_document && getClientStatusFromData(client) === 'unverified'" 
                  class="action-btn warning" 
                  title="Cliente sin documentos"
                  disabled>
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                    <line x1="12" y1="8" x2="12" y2="12" stroke="currentColor" stroke-width="2"/>
                    <line x1="12" y1="16" x2="12.01" y2="16" stroke="currentColor" stroke-width="2"/>
                  </svg>
                  Sin Docs
                </button>
                
                <button 
                  *ngIf="getClientStatusFromData(client) === 'verified'" 
                  class="action-btn success" 
                  title="Cliente verificado"
                  disabled>
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M9 12L11 14L15 10M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke="currentColor" stroke-width="2"/>
                  </svg>
                  Verificado
                </button>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Estado vacío -->
        <div *ngIf="getCurrentClients().length === 0" class="modern-empty-state">
          <div class="empty-content">
            <div class="empty-icon">
              <svg width="64" height="64" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M17 21V19C17 17.9391 16.5786 16.9217 15.8284 16.1716C15.0783 15.4214 14.0609 15 13 15H5C3.93913 15 2.92172 15.4214 2.17157 16.1716C1.42143 16.9217 1 17.9391 1 19V21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <circle cx="9" cy="7" r="4" stroke="currentColor" stroke-width="2"/>
                <path d="M23 21V19C23 18.1645 22.7155 17.3541 22.2045 16.7006C21.6935 16.047 20.9877 15.5856 20.194 15.3893" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M16 3.13C16.8604 3.35031 17.623 3.85071 18.1676 4.55232C18.7122 5.25392 19.0078 6.11683 19.0078 7.005C19.0078 7.89317 18.7122 8.75608 18.1676 9.45768C17.623 10.1593 16.8604 10.6597 16 10.88" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </div>
            <h3>No hay clientes en esta categoría</h3>
            <p>No se encontraron clientes con el filtro seleccionado.</p>
          </div>
        </div>
      </div>

      <!-- Vista Pagos -->
      <div *ngIf="currentView === 'payments'" class="payments-view">
        <div class="content-header">
          <h2>Gestión de Pagos</h2>
          <p>Administra y supervisa todas las transacciones de la plataforma</p>
        </div>
        
        <!-- Estadísticas rápidas de pagos -->
        <div class="payments-stats">
          <div class="stat-card verified">
            <div class="stat-icon">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M9 12L11 14L15 10M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </div>
            <div class="stat-content">
              <h3>{{ getPaymentCount('verified') }}</h3>
              <p>Pagos Completados</p>
            </div>
          </div>
          
          <div class="stat-card pending">
            <div class="stat-icon">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                <polyline points="12,6 12,12 16,14" stroke="currentColor" stroke-width="2"/>
              </svg>
            </div>
            <div class="stat-content">
              <h3>{{ getPaymentCount('unverified') }}</h3>
              <p>Pagos Pendientes</p>
            </div>
          </div>
          
          <div class="stat-card total">
            <div class="stat-icon">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <line x1="12" y1="1" x2="12" y2="23" stroke="currentColor" stroke-width="2"/>
                <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7H14a3.5 3.5 0 0 1 0 7H6" stroke="currentColor" stroke-width="2"/>
              </svg>
            </div>
            <div class="stat-content">
              <h3>${{ getTotalRevenue().toFixed(2) }}</h3>
              <p>Ingresos Totales</p>
            </div>
          </div>
          
          <div class="stat-card revenue">
            <div class="stat-icon">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M3 3V21H21" stroke="currentColor" stroke-width="2"/>
                <polyline points="7,8 12,3 17,8 22,3" stroke="currentColor" stroke-width="2"/>
              </svg>
            </div>
            <div class="stat-content">
              <h3>${{ getMonthlyRevenue().toFixed(2) }}</h3>
              <p>Ingresos del Mes</p>
            </div>
          </div>
        </div>

        <!-- Sección de filtros moderna -->
        <div class="modern-filter-section">
          <div class="filter-header">
            <h3>Filtrar Pagos</h3>
            <button class="toggle-date-filters-btn" (click)="toggleDateFilters()">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <rect x="3" y="4" width="18" height="18" rx="2" ry="2" stroke="currentColor" stroke-width="2"/>
                <line x1="16" y1="2" x2="16" y2="6" stroke="currentColor" stroke-width="2"/>
                <line x1="8" y1="2" x2="8" y2="6" stroke="currentColor" stroke-width="2"/>
                <line x1="3" y1="10" x2="21" y2="10" stroke="currentColor" stroke-width="2"/>
              </svg>
              Filtros por Fecha
              <svg width="12" height="12" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" 
                   [style.transform]="showDateFilters ? 'rotate(180deg)' : 'rotate(0deg)'"
                   style="transition: transform 0.3s ease;">
                <polyline points="6,9 12,15 18,9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </button>
          </div>

          <!-- Filtros de fecha desplegables -->
          <div class="date-filter-section" [class.expanded]="showDateFilters">
            <div class="date-filter-content">
              <h4>Filtrar por Fecha</h4>
              
              <!-- Filtros rápidos de fecha -->
              <div class="date-filter-tabs">
                <button 
                  (click)="setPaymentDateFilter('all')" 
                  class="date-filter-btn"
                  [class.active]="paymentDateFilter === 'all'">
                  <div class="filter-content">
                    <span class="filter-label">Todos</span>
                    <span class="filter-count">{{ getPaymentCountByDate('all') }}</span>
                  </div>
                </button>
                
                <button 
                  (click)="setPaymentDateFilter('today')" 
                  class="date-filter-btn"
                  [class.active]="paymentDateFilter === 'today'">
                  <div class="filter-content">
                    <span class="filter-label">Hoy</span>
                    <span class="filter-count">{{ getPaymentCountByDate('today') }}</span>
                  </div>
                </button>
                
                <button 
                  (click)="setPaymentDateFilter('week')" 
                  class="date-filter-btn"
                  [class.active]="paymentDateFilter === 'week'">
                  <div class="filter-content">
                    <span class="filter-label">Esta Semana</span>
                    <span class="filter-count">{{ getPaymentCountByDate('week') }}</span>
                  </div>
                </button>
                
                <button 
                  (click)="setPaymentDateFilter('month')" 
                  class="date-filter-btn"
                  [class.active]="paymentDateFilter === 'month'">
                  <div class="filter-content">
                    <span class="filter-label">Este Mes</span>
                    <span class="filter-count">{{ getPaymentCountByDate('month') }}</span>
                  </div>
                </button>

                <button 
                  (click)="setPaymentDateFilter('quarter')" 
                  class="date-filter-btn"
                  [class.active]="paymentDateFilter === 'quarter'">
                  <div class="filter-content">
                    <span class="filter-label">Este Trimestre</span>
                    <span class="filter-count">{{ getPaymentCountByDate('quarter') }}</span>
                  </div>
                </button>
                
                <button 
                  (click)="setPaymentDateFilter('custom')" 
                  class="date-filter-btn custom-date"
                  [class.active]="paymentDateFilter === 'custom'">
                  <div class="filter-content">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <rect x="3" y="4" width="18" height="18" rx="2" ry="2" stroke="currentColor" stroke-width="2"/>
                      <line x1="16" y1="2" x2="16" y2="6" stroke="currentColor" stroke-width="2"/>
                      <line x1="8" y1="2" x2="8" y2="6" stroke="currentColor" stroke-width="2"/>
                      <line x1="3" y1="10" x2="21" y2="10" stroke="currentColor" stroke-width="2"/>
                    </svg>
                    <span class="filter-label">Fecha Específica</span>
                  </div>
                </button>
              </div>

              <!-- Calendario para fecha específica -->
              <div *ngIf="paymentDateFilter === 'custom'" class="calendar-section">
                <div class="calendar-layout">
                  <!-- Calendario a la izquierda -->
                  <div class="calendar-left-panel">
                    <div class="calendar-container">
                      <div class="calendar-header">
                        <div class="calendar-title-display">{{ getCurrentMonthYear() }}</div>
                      </div>
                      
                      <div class="calendar-grid">
                        <div class="calendar-days">
                          <button 
                            *ngFor="let date of getCalendarDays()" 
                            type="button"
                            class="calendar-day"
                            [class.today]="isToday(date)"
                            [class.selected]="isSelectedDate(date)"
                            [class.other-month]="!isCurrentMonth(date)"
                            [class.has-payments]="hasPaymentsOnDate(date)"
                            (click)="selectDate(date)">
                            {{ date.getDate() }}
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>
                  
                  <!-- Controles a la derecha -->
                  <div class="calendar-right-panel">
                    <div class="date-selectors">
                      <div class="selectors-header">
                        <h4 class="selectors-title">
                          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <rect x="3" y="4" width="18" height="18" rx="2" ry="2" stroke="currentColor" stroke-width="2"/>
                            <line x1="16" y1="2" x2="16" y2="6" stroke="currentColor" stroke-width="2"/>
                            <line x1="8" y1="2" x2="8" y2="6" stroke="currentColor" stroke-width="2"/>
                            <line x1="3" y1="10" x2="21" y2="10" stroke="currentColor" stroke-width="2"/>
                          </svg>
                          Navegación Rápida
                        </h4>
                      </div>
                      
                      <div class="year-month-selectors">
                        <div class="selector-group">
                          <label for="yearSelect" class="selector-label">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                              <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2"/>
                              <path d="M12 1v6m0 6v6" stroke="currentColor" stroke-width="2"/>
                              <path d="m21 12-6-6-6 6" stroke="currentColor" stroke-width="2"/>
                            </svg>
                            Año
                          </label>
                          <div class="selector-wrapper">
                            <select id="yearSelect" 
                                    [(ngModel)]="selectedYear" 
                                    (change)="onYearChange()"
                                    class="year-selector">
                              <option *ngFor="let year of getAvailableYears()" [value]="year">{{ year }}</option>
                            </select>
                            <div class="selector-arrow">
                              <svg width="12" height="12" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <polyline points="6,9 12,15 18,9" stroke="currentColor" stroke-width="2"/>
                              </svg>
                            </div>
                          </div>
                        </div>
                        
                        <div class="selector-group">
                          <label for="monthSelect" class="selector-label">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                              <rect x="3" y="4" width="18" height="18" rx="2" ry="2" stroke="currentColor" stroke-width="2"/>
                              <line x1="16" y1="2" x2="16" y2="6" stroke="currentColor" stroke-width="2"/>
                              <line x1="8" y1="2" x2="8" y2="6" stroke="currentColor" stroke-width="2"/>
                            </svg>
                            Mes
                          </label>
                          <div class="selector-wrapper">
                            <select id="monthSelect" 
                                    [(ngModel)]="selectedMonth" 
                                    (change)="onMonthChange()"
                                    class="month-selector">
                              <option *ngFor="let month of getAvailableMonths(); let i = index" [value]="i">{{ month }}</option>
                            </select>
                            <div class="selector-arrow">
                              <svg width="12" height="12" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <polyline points="6,9 12,15 18,9" stroke="currentColor" stroke-width="2"/>
                              </svg>
                            </div>
                          </div>
                        </div>
                      </div>
                      
                      <div class="quick-actions">
                        <button type="button" class="quick-action-btn today-btn" (click)="goToToday()">
                          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                            <polyline points="12,6 12,12 16,14" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                          </svg>
                          Ir a Hoy
                        </button>
                        
                        <button type="button" class="quick-action-btn clear-btn" (click)="clearSelectedDate()">
                          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <line x1="18" y1="6" x2="6" y2="18" stroke="currentColor" stroke-width="2"/>
                            <line x1="6" y1="6" x2="18" y2="18" stroke="currentColor" stroke-width="2"/>
                          </svg>
                          Limpiar Selección
                        </button>
                      </div>
                      
                      <div *ngIf="selectedDate" class="selected-date-info-compact">
                        <div class="date-info-header">
                          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M9 12L11 14L15 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                          </svg>
                          <span class="date-info-title">Fecha Seleccionada</span>
                        </div>
                        <div class="date-info-content">
                          <div class="date-icon">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                              <rect x="3" y="4" width="18" height="18" rx="2" ry="2" stroke="currentColor" stroke-width="2"/>
                              <line x1="16" y1="2" x2="16" y2="6" stroke="currentColor" stroke-width="2"/>
                              <line x1="8" y1="2" x2="8" y2="6" stroke="currentColor" stroke-width="2"/>
                              <line x1="3" y1="10" x2="21" y2="10" stroke="currentColor" stroke-width="2"/>
                            </svg>
                          </div>
                          <div class="date-text">
                            <span class="date-value">{{ formatSelectedDate(selectedDate) }}</span>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Filtros de estado -->
          <div class="modern-filter-tabs">
            <button 
              (click)="setPaymentFilter('verified')" 
              class="modern-filter-tab"
              [class.active]="paymentFilter === 'verified'">
              <div class="filter-tab-content">
                <div class="tab-icon verified">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M9 12L11 14L15 10M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </div>
                <div class="tab-info">
                  <span class="tab-title">Completados</span>
                  <span class="tab-count">{{ getPaymentCount('verified') }}</span>
                </div>
              </div>
            </button>
            
            <button 
              (click)="setPaymentFilter('unverified')" 
              class="modern-filter-tab"
              [class.active]="paymentFilter === 'unverified'">
              <div class="filter-tab-content">
                <div class="tab-icon pending">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                    <polyline points="12,6 12,12 16,14" stroke="currentColor" stroke-width="2"/>
                  </svg>
                </div>
                <div class="tab-info">
                  <span class="tab-title">Pendientes</span>
                  <span class="tab-count">{{ getPaymentCount('unverified') }}</span>
                </div>
              </div>
            </button>
          </div>
        </div>

        <!-- Grid moderno de pagos -->
        <div class="modern-payments-grid">
          <div *ngFor="let payment of getCurrentPayments()" class="modern-payment-card">
            <!-- Header de la tarjeta -->
            <div class="payment-card-header">
              <div class="payment-profile">
                <div class="payment-icon-container">
                  <div class="payment-icon">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <rect x="1" y="4" width="22" height="16" rx="2" ry="2" stroke="currentColor" stroke-width="2"/>
                      <line x1="1" y1="10" x2="23" y2="10" stroke="currentColor" stroke-width="2"/>
                    </svg>
                  </div>
                  <div class="payment-status-indicator" [class]="'status-' + getPaymentStatusFromData(payment)"></div>
                </div>
                <div class="payment-basic-info">
                  <div class="payment-header-info">
                    <h3 class="payment-id">Pago #{{ payment.id }}</h3>
                    <span class="payment-badge" [class]="getPaymentStatusFromData(payment)">
                      {{ getPaymentStatusText(getPaymentStatusFromData(payment)) }}
                    </span>
                  </div>
                  <div class="payment-amount-header">
                    <span class="amount">${{ payment.amount.toFixed(2) }}</span>
                    <span class="payment-date">{{ formatPaymentDate(payment.paymentDate || payment.createdAt) }}</span>
                  </div>
                </div>
              </div>
            </div>

            <!-- Contenido de la tarjeta -->
            <div class="payment-card-content">
              <div class="payment-details">
                <div class="detail-item">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M20 21V19C20 17.9391 19.5786 16.9217 18.8284 16.1716C18.0783 15.4214 17.0609 15 16 15H8C6.93913 15 5.92172 15.4214 5.17157 16.1716C4.42143 16.9217 4 17.9391 4 19V21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <circle cx="12" cy="7" r="4" stroke="currentColor" stroke-width="2"/>
                  </svg>
                  <span>Cliente: {{ payment.client.name }}</span>
                </div>
                <div class="detail-item">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M17 21V19C17 17.9391 16.5786 16.9217 15.8284 16.1716C15.0783 15.4214 14.0609 15 13 15H5C3.93913 15 2.92172 15.4214 2.17157 16.1716C1.42143 16.9217 1 17.9391 1 19V21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <circle cx="9" cy="7" r="4" stroke="currentColor" stroke-width="2"/>
                    <path d="M23 21V19C23 18.1645 22.7155 17.3541 22.2045 16.7006C21.6935 16.047 20.9877 15.5856 20.194 15.3893" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M16 3.13C16.8604 3.35031 17.623 3.85071 18.1676 4.55232C18.7122 5.25392 19.0078 6.11683 19.0078 7.005C19.0078 7.89317 18.7122 8.75608 18.1676 9.45768C17.623 10.1593 16.8604 10.6597 16 10.88" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                  <span>Nanny: {{ payment.nanny.first_name }} {{ payment.nanny.last_name }}</span>
                </div>
                <div class="detail-item">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                    <polyline points="12,6 12,12 16,14" stroke="currentColor" stroke-width="2"/>
                  </svg>
                  <span>{{ payment.service.totalHours }} horas de servicio</span>
                </div>
                <div class="detail-item">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2" stroke="currentColor" stroke-width="2"/>
                    <line x1="16" y1="2" x2="16" y2="6" stroke="currentColor" stroke-width="2"/>
                    <line x1="8" y1="2" x2="8" y2="6" stroke="currentColor" stroke-width="2"/>
                    <line x1="3" y1="10" x2="21" y2="10" stroke="currentColor" stroke-width="2"/>
                  </svg>
                  <span>{{ payment.service.startDate }}</span>
                </div>
              </div>
            </div>

            <!-- Footer con acciones -->
            <div class="payment-card-footer">
              <div class="payment-stats">
                <div class="stat-item">
                  <span class="stat-label">Monto para nanny</span>
                  <span class="stat-value">${{ payment.nannyAmount.toFixed(2) }}</span>
                </div>
                <div class="stat-item">
                  <span class="stat-label">Comisión</span>
                  <span class="stat-value">${{ payment.platformFee.toFixed(2) }}</span>
                </div>
              </div>
              <div class="payment-actions">
                <button class="action-btn secondary" title="Ver detalles">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M1 12S5 4 12 4S23 12 23 12S19 20 12 20S1 12 1 12Z" stroke="currentColor" stroke-width="2"/>
                    <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2"/>
                  </svg>
                  Ver Detalles
                </button>
                <button 
                  *ngIf="paymentFilter === 'unverified'" 
                  class="action-btn primary" 
                  title="Verificar pago">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M9 12L11 14L15 10M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                  Verificar
                </button>
                <button 
                  *ngIf="paymentFilter === 'verified'" 
                  class="action-btn primary" 
                  title="Generar recibo">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" stroke="currentColor" stroke-width="2"/>
                    <polyline points="14,2 14,8 20,8" stroke="currentColor" stroke-width="2"/>
                    <line x1="16" y1="13" x2="8" y2="13" stroke="currentColor" stroke-width="2"/>
                    <line x1="16" y1="17" x2="8" y2="17" stroke="currentColor" stroke-width="2"/>
                    <polyline points="10,9 9,9 8,9" stroke="currentColor" stroke-width="2"/>
                  </svg>
                  Recibo
                </button>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Estado vacío -->
        <div *ngIf="getCurrentPayments().length === 0" class="modern-empty-state">
          <div class="empty-content">
            <div class="empty-icon">
              <svg width="64" height="64" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <rect x="1" y="4" width="22" height="16" rx="2" ry="2" stroke="currentColor" stroke-width="2"/>
                <line x1="1" y1="10" x2="23" y2="10" stroke="currentColor" stroke-width="2"/>
              </svg>
            </div>
            <h3>No hay pagos en esta categoría</h3>
            <p>No se encontraron pagos con el filtro seleccionado.</p>
          </div>
        </div>
      </div>

      <!-- Vista Datos Bancarios -->
      <div *ngIf="currentView === 'datos-bancarios'" class="banking-view">
        <div class="content-header">
          <div class="header-content">
            <div class="header-text">
              <h2>💳 Datos Bancarios</h2>
              <p>Gestión de información bancaria de las nannys</p>
            </div>
            <button class="modern-add-btn" (click)="openBankDetailsModal()">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <line x1="12" y1="5" x2="12" y2="19" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
                <line x1="5" y1="12" x2="19" y2="12" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
              </svg>
              Agregar Datos Bancarios
            </button>
          </div>
        </div>

        <!-- Estadísticas rápidas -->
        <div class="banking-stats">
          <div class="stat-card banking-stat">
            <div class="stat-icon">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <rect x="2" y="4" width="20" height="16" rx="2" stroke="currentColor" stroke-width="2"/>
                <line x1="2" y1="10" x2="22" y2="10" stroke="currentColor" stroke-width="2"/>
              </svg>
            </div>
            <div class="stat-content">
              <div class="stat-label">Total Cuentas</div>
              <div class="stat-number">{{ datosBancarios.length }}</div>
            </div>
          </div>

          <div class="stat-card active-stat">
            <div class="stat-icon">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                <polyline points="22 4 12 14.01 9 11.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              </svg>
            </div>
            <div class="stat-content">
              <div class="stat-label">Cuentas Activas</div>
              <div class="stat-number">{{ getActiveBankAccountsCount() }}</div>
            </div>
          </div>

          <div class="stat-card verified-stat">
            <div class="stat-icon">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z" stroke="currentColor" stroke-width="2"/>
                <polyline points="9 12 11 14 15 10" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              </svg>
            </div>
            <div class="stat-content">
              <div class="stat-label">Nannys Verificadas</div>
              <div class="stat-number">{{ getVerifiedNannysWithBankCount() }}</div>
            </div>
          </div>
        </div>

        <!-- Lista de datos bancarios -->
        <div class="modern-banking-grid">
          <div *ngFor="let datos of datosBancarios" 
               class="modern-bank-card" 
               [class.inactive-card]="!datos.isActive">
            
            <!-- Header de la tarjeta -->
            <div class="bank-card-header">
              <div class="bank-logo-section">
                <div class="bank-logo">
                  <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" stroke="currentColor" stroke-width="2"/>
                    <polyline points="9 22 9 12 15 12 15 22" stroke="currentColor" stroke-width="2"/>
                  </svg>
                </div>
                <div class="bank-name-section">
                  <h3>{{ datos.bankName }}</h3>
                  <span class="account-type-badge">{{ datos.accountType === 'savings' ? '💰 Ahorro' : '🏦 Corriente' }}</span>
                </div>
              </div>
              <div class="status-badge-container">
                <span class="modern-status-badge" [class.active]="datos.isActive" [class.inactive]="!datos.isActive">
                  <span class="status-dot"></span>
                  {{ datos.isActive ? 'Activa' : 'Inactiva' }}
                </span>
              </div>
            </div>

            <!-- Información de la nanny -->
            <div class="bank-card-nanny">
              <div class="nanny-avatar-modern">
                <div class="avatar-circle">
                  {{ (datos.nanny.first_name.charAt(0) || 'N') + (datos.nanny.last_name.charAt(0) || 'A') }}
                </div>
                <div class="verification-icon" *ngIf="datos.nanny.status === 'active'">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    <polyline points="22 4 12 14.01 9 11.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                  </svg>
                </div>
              </div>
              <div class="nanny-info-modern">
                <h4>{{ datos.nanny.first_name }} {{ datos.nanny.last_name }}</h4>
                <p class="nanny-email-modern">{{ datos.nanny.email }}</p>
                <span class="verification-badge" [class.verified]="datos.nanny.status === 'active'" [class.unverified]="datos.nanny.status !== 'active'">
                  {{ datos.nanny.status === 'active' ? 'Verificada' : 'Sin verificar' }}
                </span>
              </div>
            </div>

            <!-- Detalles de la cuenta -->
            <div class="bank-card-details">
              <div class="detail-row">
                <div class="detail-label">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" stroke="currentColor" stroke-width="2"/>
                    <circle cx="12" cy="7" r="4" stroke="currentColor" stroke-width="2"/>
                  </svg>
                  Titular
                </div>
                <div class="detail-value">{{ datos.accountHolderName }}</div>
              </div>

              <div class="detail-row">
                <div class="detail-label">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <rect x="2" y="4" width="20" height="16" rx="2" stroke="currentColor" stroke-width="2"/>
                    <line x1="2" y1="10" x2="22" y2="10" stroke="currentColor" stroke-width="2"/>
                  </svg>
                  Número de Cuenta
                </div>
                <div class="detail-value account-number">{{ maskAccountNumber(datos.accountNumber) }}</div>
              </div>

              <div class="detail-row" *ngIf="datos.clabe">
                <div class="detail-label">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <rect x="3" y="11" width="18" height="11" rx="2" ry="2" stroke="currentColor" stroke-width="2"/>
                    <path d="M7 11V7a5 5 0 0 1 10 0v4" stroke="currentColor" stroke-width="2"/>
                  </svg>
                  CLABE Interbancaria
                </div>
                <div class="detail-value clabe-number">{{ datos.clabe }}</div>
              </div>
            </div>

            <!-- Acciones -->
            <div class="bank-card-actions">
              <button class="modern-action-btn edit-btn" (click)="openBankDetailsModal(datos)">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                  <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                </svg>
                Editar
              </button>
              
              <button class="modern-action-btn toggle-btn" (click)="toggleBankDataStatus(datos.id)">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <rect x="1" y="5" width="22" height="14" rx="7" stroke="currentColor" stroke-width="2"/>
                  <circle cx="16" cy="12" r="3" fill="currentColor"/>
                </svg>
                {{ datos.isActive ? 'Desactivar' : 'Activar' }}
              </button>

              <button class="modern-action-btn delete-btn" (click)="deleteBankData(datos.id)">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <polyline points="3 6 5 6 21 6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                  <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                  <line x1="10" y1="11" x2="10" y2="17" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                  <line x1="14" y1="11" x2="14" y2="17" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                </svg>
                Eliminar
              </button>
            </div>
          </div>
          
          <!-- Estado vacío si no hay datos bancarios -->
          <div *ngIf="datosBancarios.length === 0" class="modern-empty-state">
            <div class="empty-illustration">
              <svg width="120" height="120" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" stroke="#E31B7E" stroke-width="1.5"/>
                <polyline points="9 22 9 12 15 12 15 22" stroke="#E31B7E" stroke-width="1.5"/>
                <line x1="2" y1="9" x2="22" y2="9" stroke="#E31B7E" stroke-width="1.5"/>
              </svg>
            </div>
            <h3>No hay datos bancarios registrados</h3>
            <p>Agrega información bancaria para las nannys para facilitar los pagos y transferencias.</p>
            <button class="modern-add-first-btn" (click)="openBankDetailsModal()">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <line x1="12" y1="5" x2="12" y2="19" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                <line x1="5" y1="12" x2="19" y2="12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              </svg>
              Agregar Primer Registro
            </button>
          </div>
        </div>
      </div>
    </main>
  </div>

  <!-- Modal de datos bancarios -->
  <div class="bank-modal-overlay" *ngIf="showBankDetailsModal" (click)="closeBankDetailsModal()">
    <div class="bank-modal-content" (click)="$event.stopPropagation()">
      <div class="bank-modal-header">
        <h3>{{ editingBankData ? 'Editar' : 'Agregar' }} Datos Bancarios</h3>
        <button class="close-modal-btn" (click)="closeBankDetailsModal()">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <line x1="18" y1="6" x2="6" y2="18" stroke="currentColor" stroke-width="2"/>
            <line x1="6" y1="6" x2="18" y2="18" stroke="currentColor" stroke-width="2"/>
          </svg>
        </button>
      </div>

      <form class="bank-modal-form" (ngSubmit)="saveBankDetails()" #bankForm="ngForm">
        <!-- Selección de nanny (solo al crear) -->
        <div class="form-group" *ngIf="!editingBankData">
          <label for="nannySelect">Seleccionar Nanny *</label>
          <select id="nannySelect" 
                  [(ngModel)]="selectedBankData.nanny_id" 
                  name="nanny_id" 
                  required
                  class="form-control">
            <option value="">Seleccione una nanny</option>
            <option *ngFor="let nanny of getAvailableNannysForBankData()" [value]="nanny.id">
              {{ nanny.first_name }} {{ nanny.last_name }}
            </option>
          </select>
        </div>

        <!-- Información del titular -->
        <div class="form-group">
          <label for="nombreTitular">Nombre del Titular *</label>
          <input type="text" 
                 id="nombreTitular" 
                 [(ngModel)]="selectedBankData.nombre_titular" 
                 name="nombre_titular" 
                 required
                 maxlength="150"
                 class="form-control"
                 placeholder="Nombre completo del titular de la cuenta">
        </div>

        <!-- Banco -->
        <div class="form-group">
          <label for="banco">Banco *</label>
          <select id="banco" 
                  [(ngModel)]="selectedBankData.banco" 
                  name="banco" 
                  required
                  class="form-control">
            <option value="">Seleccione un banco</option>
            <option value="BBVA Bancomer">BBVA Bancomer</option>
            <option value="Santander">Santander</option>
            <option value="Banorte">Banorte</option>
            <option value="HSBC">HSBC</option>
            <option value="Scotiabank">Scotiabank</option>
            <option value="Inbursa">Inbursa</option>
            <option value="Azteca">Banco Azteca</option>
            <option value="Otro">Otro</option>
          </select>
        </div>

        <!-- Número de cuenta -->
        <div class="form-group">
          <label for="numeroCuenta">Número de Cuenta *</label>
          <input type="text" 
                 id="numeroCuenta" 
                 [(ngModel)]="selectedBankData.numero_cuenta_completo" 
                 name="numero_cuenta_completo" 
                 required
                 minlength="8"
                 maxlength="50"
                 class="form-control"
                 placeholder="Número de cuenta bancaria">
        </div>

        <!-- CLABE -->
        <div class="form-group">
          <label for="clabe">CLABE Interbancaria</label>
          <input type="text" 
                 id="clabe" 
                 [(ngModel)]="selectedBankData.clabe" 
                 name="clabe" 
                 maxlength="18"
                 class="form-control"
                 placeholder="CLABE de 18 dígitos (opcional)">
        </div>

        <!-- Tipo de cuenta -->
        <div class="form-group">
          <label for="tipoCuenta">Tipo de Cuenta *</label>
          <select id="tipoCuenta" 
                  [(ngModel)]="selectedBankData.tipo_cuenta" 
                  name="tipo_cuenta" 
                  required
                  class="form-control">
            <option value="ahorro">Cuenta de Ahorro</option>
            <option value="corriente">Cuenta Corriente</option>
          </select>
        </div>

        <!-- Estado activo -->
        <div class="form-group checkbox-group">
          <label class="checkbox-label">
            <input type="checkbox" 
                   [(ngModel)]="selectedBankData.es_activa" 
                   name="es_activa">
            <span class="checkmark"></span>
            Cuenta activa
          </label>
        </div>

        <!-- Botones de acción -->
        <div class="modal-actions">
          <button type="button" class="cancel-btn" (click)="closeBankDetailsModal()">
            Cancelar
          </button>
          <button type="submit" class="save-btn" [disabled]="!bankForm.form.valid">
            {{ editingBankData ? 'Actualizar' : 'Guardar' }} Datos
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Modal para agregar nueva nanny - PROFESIONAL -->
  <div *ngIf="showAddNannyModal" class="modal-overlay professional-overlay" (click)="closeAddNannyModal()">
    <div class="modal-container professional-nanny-modal" (click)="$event.stopPropagation()">
      <!-- Header del modal mejorado -->
      <div class="professional-modal-header">
        <div class="header-gradient"></div>
        <div class="header-content">
          <div class="header-icon">
            <svg width="32" height="32" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
              <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm3.5-9c.83 0 1.5-.67 1.5-1.5S16.33 8 15.5 8 14 8.67 14 9.5s.67 1.5 1.5 1.5zm-7 0c.83 0 1.5-.67 1.5-1.5S9.33 8 8.5 8 7 8.67 7 9.5 7.67 11 8.5 11zm3.5 6.5c2.33 0 4.31-1.46 5.11-3.5H6.89c.8 2.04 2.78 3.5 5.11 3.5z"/>
            </svg>
          </div>
          <h2>Registrar Nueva Nanny</h2>
          <p>Agrega una cuidadora profesional a la plataforma</p>
        </div>
        <button class="professional-close-btn" (click)="closeAddNannyModal()">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M18 6L6 18M6 6L18 18" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
      </div>

      <!-- Cuerpo del modal -->
      <div class="professional-modal-body">
        <form #addNannyForm="ngForm" (ngSubmit)="onSubmitAddNanny(addNannyForm)" class="professional-form">
          
          <!-- Sección 1: Información Personal -->
          <div class="form-section-professional">
            <div class="section-header-professional">
              <div class="section-number">1</div>
              <div class="section-info">
                <h3>Información Personal</h3>
                <p>Datos básicos de la cuidadora</p>
              </div>
            </div>
            
            <div class="form-grid-2">
              <div class="form-group-professional">
                <label for="firstName">
                  <span class="label-text">Nombre</span>
                  <span class="required-star">*</span>
                </label>
                <input type="text" 
                       id="firstName" 
                       [(ngModel)]="newNannyData.first_name" 
                       name="first_name" 
                       required
                       minlength="2"
                       class="input-professional"
                       placeholder="María">
              </div>
              
              <div class="form-group-professional">
                <label for="lastName">
                  <span class="label-text">Apellido</span>
                  <span class="required-star">*</span>
                </label>
                <input type="text" 
                       id="lastName" 
                       [(ngModel)]="newNannyData.last_name" 
                       name="last_name" 
                       required
                       minlength="2"
                       class="input-professional"
                       placeholder="García López">
              </div>
            </div>

            <div class="form-grid-2">
              <div class="form-group-professional">
                <label for="email">
                  <span class="label-text">Correo Electrónico</span>
                  <span class="required-star">*</span>
                </label>
                <input type="email" 
                       id="email" 
                       [(ngModel)]="newNannyData.email" 
                       name="email" 
                       required
                       class="input-professional"
                       placeholder="maria.garcia@email.com">
              </div>
              
              <div class="form-group-professional">
                <label for="phone">
                  <span class="label-text">Teléfono</span>
                  <span class="required-star">*</span>
                </label>
                <input type="tel" 
                       id="phone" 
                       [(ngModel)]="newNannyData.phone_number" 
                       name="phone_number" 
                       required
                       class="input-professional"
                       placeholder="+34 666 123 456">
              </div>
            </div>

            <div class="form-group-professional">
              <label for="address">
                <span class="label-text">Dirección</span>
              </label>
              <input type="text" 
                     id="address" 
                     [(ngModel)]="newNannyData.address" 
                     name="address" 
                     class="input-professional"
                     placeholder="Calle Principal 123, Madrid">
            </div>
          </div>

          <!-- Separador visual -->
          <div class="section-divider-professional"></div>

          <!-- Sección 2: Información Profesional -->
          <div class="form-section-professional">
            <div class="section-header-professional">
              <div class="section-number">2</div>
              <div class="section-info">
                <h3>Información Profesional</h3>
                <p>Experiencia y tarifas</p>
              </div>
            </div>
            
            <div class="form-grid-2">
              <div class="form-group-professional">
                <label for="experience_years">
                  <span class="label-text">Años de Experiencia</span>
                  <span class="required-star">*</span>
                </label>
                <div class="input-with-suffix">
                  <input type="number" 
                         id="experience_years" 
                         [(ngModel)]="newNannyData.experience_years" 
                         name="experience_years" 
                         required
                         min="0"
                         max="60"
                         class="input-professional"
                         placeholder="5">
                  <span class="input-suffix">años</span>
                </div>
              </div>
              
              <div class="form-group-professional">
                <label for="hourly_rate">
                  <span class="label-text">Tarifa por Hora</span>
                  <span class="required-star">*</span>
                </label>
                <div class="input-with-prefix">
                  <span class="input-prefix">€</span>
                  <input type="number" 
                         id="hourly_rate" 
                         [(ngModel)]="newNannyData.hourly_rate" 
                         name="hourly_rate" 
                         required
                         min="10"
                         max="100"
                         step="0.50"
                         class="input-professional"
                         placeholder="15.00">
                </div>
              </div>
            </div>

            <div class="form-group-professional">
              <label for="description">
                <span class="label-text">Descripción Profesional</span>
                <span class="required-star">*</span>
                <span class="label-hint">(Máximo 500 caracteres)</span>
              </label>
              <textarea id="description" 
                        [(ngModel)]="newNannyData.description" 
                        name="description" 
                        required
                        rows="4"
                        maxlength="500"
                        class="input-professional textarea-professional"
                        placeholder="Comparte tu experiencia, especialidades, idiomas, certificaciones..."></textarea>
              <div class="character-counter">
                <span>{{ (newNannyData.description || '').length }}/500</span>
              </div>
            </div>
          </div>

          <!-- Separador visual -->
          <div class="section-divider-professional"></div>

          <!-- Sección 3: Disponibilidad -->
          <div class="form-section-professional">
            <div class="section-header-professional">
              <div class="section-number">3</div>
              <div class="section-info">
                <h3>Disponibilidad</h3>
                <p>Estado inicial de la cuidadora</p>
              </div>
            </div>
            
            <div class="availability-card">
              <input type="checkbox" 
                     id="isAvailable" 
                     [(ngModel)]="newNannyData.is_available" 
                     name="is_available"
                     class="availability-checkbox">
              <label for="isAvailable" class="availability-label">
                <div class="availability-check"></div>
                <div class="availability-content">
                  <span class="availability-title">Disponible Inmediatamente</span>
                  <span class="availability-desc">La cuidadora podrá aceptar servicios desde el primer día</span>
                </div>
              </label>
            </div>

            <div class="form-group-professional" *ngIf="!newNannyData.is_available" [@fadeInOut]>
              <label for="reason">
                <span class="label-text">Razón de Indisponibilidad</span>
              </label>
              <textarea id="reason" 
                        [(ngModel)]="newNannyData.reason" 
                        name="reason" 
                        rows="2"
                        class="input-professional textarea-professional"
                        placeholder="Ej: De vacaciones hasta el 20 de noviembre"></textarea>
            </div>

            <div class="info-alert">
              <div class="alert-icon">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                  <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/>
                </svg>
              </div>
              <div class="alert-content">
                <strong>Estado automático:</strong> Las nannys registradas aquí se crearán como verificadas y activas de inmediato.
              </div>
            </div>
          </div>
        </form>
      </div>

      <!-- Footer del modal -->
      <div class="professional-modal-footer">
        <div class="footer-background"></div>
        <button type="button" class="btn-secondary-professional" (click)="closeAddNannyModal()">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M19 6.41L17.59 5L12 10.59L6.41 5L5 6.41L10.59 12L5 17.59L6.41 19L12 13.41L17.59 19L19 17.59L13.41 12L19 6.41Z" fill="currentColor"/>
          </svg>
          Cancelar
        </button>
        <button type="submit" 
                class="btn-primary-professional" 
                (click)="onSubmitAddNanny(addNannyForm)"
                [disabled]="!addNannyForm.form.valid">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z" fill="currentColor"/>
          </svg>
          <span *ngIf="!isSubmitting">Registrar Nanny</span>
          <span *ngIf="isSubmitting">Guardando...</span>
        </button>
      </div>
    </div>
  </div>

  <!-- Modal de confirmación para cerrar sesión -->
  <!-- Modal de logout reutilizable -->
  <app-logout-modal 
    [isVisible]="showLogoutModal"
    [userName]="currentUser.name"
    [userRole]="currentUser.role"
    [redirectRoute]="'/'"
    (onCancel)="closeLogoutModal()"
    (onConfirm)="confirmLogout()">
  </app-logout-modal>

  <!-- Modal para verificar documentos de cliente -->
  <div *ngIf="showVerifyDocumentModal" class="modal-overlay" (click)="closeVerifyDocumentModal()">
    <div class="modal-container verify-document-modal" (click)="$event.stopPropagation()">
      <!-- Header del modal -->
      <div class="modal-header">
        <div class="modal-header-content">
          <div class="modal-icon verify-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z" stroke="currentColor" stroke-width="2"/>
              <polyline points="13,2 13,9 20,9" stroke="currentColor" stroke-width="2"/>
              <path d="M9 13L11 15L15 11" stroke="currentColor" stroke-width="2"/>
            </svg>
          </div>
          <div>
            <h2>Verificar Documento de Identificación</h2>
            <p style="margin: 4px 0 0 0; font-size: 14px; color: rgba(255,255,255,0.85);">{{ selectedClientForVerification?.name }}</p>
          </div>
        </div>
        <button class="modal-close-btn" (click)="closeVerifyDocumentModal()">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <line x1="18" y1="6" x2="6" y2="18" stroke="currentColor" stroke-width="2"/>
            <line x1="6" y1="6" x2="18" y2="18" stroke="currentColor" stroke-width="2"/>
          </svg>
        </button>
      </div>

      <!-- Cuerpo del modal -->
      <div class="modal-body">
      <!-- Información del cliente -->
      <div class="client-verification-info">
        <div class="info-grid">
          <div class="info-item">
            <span class="label"> Email</span>
            <span class="value">{{ selectedClientForVerification?.email }}</span>
          </div>
          <div class="info-item">
            <span class="label"> Teléfono</span>
            <span class="value">{{ selectedClientForVerification?.phone || '—' }}</span>
          </div>
          <div class="info-item">
            <span class="label"> Número de niños</span>
            <span class="value">{{ selectedClientForVerification?.numberOfChildren }}</span>
          </div>
        </div>
      </div>

        <!-- Preview del documento -->
        <div class="document-verification-preview">
          <h4>Documento de Identificación:</h4>
          
          <!-- Preview de imagen -->
          <div class="document-image-container" *ngIf="isClientDocumentImage(selectedClientForVerification)">
            <img 
              [src]="getClientDocumentUrl(selectedClientForVerification)" 
              alt="Documento de identificación" 
              class="verification-document-image">
          </div>
          
          <!-- Preview de PDF -->
          <div class="document-pdf-container" *ngIf="isClientDocumentPDF(selectedClientForVerification)">
            <div class="pdf-preview-info">
              <div class="pdf-icon-large">
                <svg width="64" height="64" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z" stroke="#e11d48" stroke-width="2" fill="#fef2f2"/>
                  <polyline points="13,2 13,9 20,9" stroke="#e11d48" stroke-width="2"/>
                  <text x="12" y="16" text-anchor="middle" font-size="8" fill="#e11d48">PDF</text>
                </svg>
              </div>
              <p class="pdf-file-name">{{ selectedClientForVerification?.identification_document }}</p>
              <a 
                [href]="getClientDocumentUrl(selectedClientForVerification)" 
                target="_blank" 
                class="view-full-pdf-btn">
                Abrir PDF completo
              </a>
            </div>
          </div>
        </div>
      </div>

      <!-- Footer del modal con acciones -->
      <div class="verification-actions">
        <div class="action-buttons">
          <button 
            type="button" 
            class="btn-reject" 
            (click)="rejectClientVerification(selectedClientForVerification)"
            [disabled]="isVerifyingDocument"
            title="Rechazar documento">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
              <line x1="15" y1="9" x2="9" y2="15" stroke="currentColor" stroke-width="2"/>
              <line x1="9" y1="9" x2="15" y2="15" stroke="currentColor" stroke-width="2"/>
            </svg>
            {{ isVerifyingDocument ? 'Procesando...' : 'Rechazar' }}
          </button>
          
          <button 
            type="button" 
            class="btn-approve" 
            (click)="approveClientVerification(selectedClientForVerification)"
            [disabled]="isVerifyingDocument"
            title="Aprobar documento">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M9 12L11 14L15 10M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke="currentColor" stroke-width="2"/>
            </svg>
            {{ isVerifyingDocument ? 'Procesando...' : 'Aprobar' }}
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal para ver perfil del cliente - DISEÑO PROFESIONAL -->
  <div *ngIf="showClientProfileModal" class="modal-overlay professional-overlay" (click)="closeClientProfileModal()">
    <div class="modal-container client-profile-modal-pro" (click)="$event.stopPropagation()">
      <!-- Header con gradiente y datos principales -->
      <div class="client-profile-header-pro">
        <div class="header-gradient-client-pro"></div>
        <div class="header-content-pro" *ngIf="selectedClientProfile">
          <div class="avatar-section-pro">
            <div class="avatar-large-pro client-avatar">
              {{ (selectedClientProfile.name || 'C')[0] }}<span>{{ (selectedClientProfile.name || 'C').split(' ')[1]?.[0] || 'C' }}</span>
            </div>
          </div>
          <div class="header-info-pro">
            <h2>{{ selectedClientProfile.name }}</h2>
            <p class="client-role">Cliente VIP</p>
            <div class="quick-status-pro">
              <span class="status-pill" [class.verified]="selectedClientProfile.verificationStatus === 'verified'">
                {{ selectedClientProfile.verificationStatus === 'verified' ? 'Verificado' : 'Pendiente' }}
              </span>
            </div>
          </div>
        </div>
        <button class="professional-close-btn" (click)="closeClientProfileModal()">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M18 6L6 18M6 6L18 18" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
          </svg>
        </button>
      </div>

      <!-- Contenido del modal -->
      <div class="client-profile-content-pro">
        <!-- Primera fila: Contacto e Información Familiar -->
        <div class="profile-cards-grid">
          <!-- Tarjeta de Contacto -->
          <div class="profile-card-pro">
            <div class="card-header-pro">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
              <h3>Información de Contacto</h3>
            </div>
            <div class="card-content-pro">
              <div class="contact-item">
                <span class="contact-label">Email</span>
                <a [href]="'mailto:' + selectedClientProfile.email" class="contact-value">
                  {{ selectedClientProfile.email }}
                </a>
              </div>
              <div class="contact-item">
                <span class="contact-label">Teléfono</span>
                <a [href]="'tel:' + selectedClientProfile.phone" class="contact-value">
                  {{ selectedClientProfile.phone || 'No disponible' }}
                </a>
              </div>
              <div class="contact-item">
                <span class="contact-label">Dirección</span>
                <p class="contact-value">{{ selectedClientProfile.address || 'No proporcionada' }}</p>
              </div>
            </div>
          </div>

          <!-- Tarjeta de Familia -->
          <div class="profile-card-pro">
            <div class="card-header-pro">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <circle cx="9" cy="7" r="4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M23 21v-2a4 4 0 0 0-3-3.87" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M16 3.13a4 4 0 0 1 0 7.75" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
              <h3>Información Familiar</h3>
            </div>
            <div class="card-content-pro">
              <div class="exp-item">
                <span class="exp-label">Número de Niños</span>
                <span class="exp-value">{{ selectedClientProfile.numberOfChildren || 'No especificado' }}</span>
              </div>
              <div class="exp-item">
                <span class="exp-label">Contacto de Emergencia</span>
                <span class="exp-value">{{ selectedClientProfile.emergencyContactName || 'No especificado' }}</span>
              </div>
              <div class="exp-item">
                <span class="exp-label">Teléfono Emergencia</span>
                <span class="exp-value">{{ selectedClientProfile.emergencyContactPhone || 'No especificado' }}</span>
              </div>
            </div>
          </div>

          <!-- Tarjeta de Estado -->
          <div class="profile-card-pro">
            <div class="card-header-pro">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <polyline points="20 6 9 17 4 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
              <h3>Verificación</h3>
            </div>
            <div class="card-content-pro verification-card">
              <div class="verification-display">
                <span class="verification-badge-pro" [class]="selectedClientProfile.verificationStatus">
                  {{ getClientStatusText(selectedClientProfile.verificationStatus) }}
                </span>
              </div>
              <p class="verification-info" *ngIf="selectedClientProfile.verificationDate">
                {{ formatDate(selectedClientProfile.verificationDate) }}
              </p>
            </div>
          </div>
        </div>

        <!-- Segunda fila: Requisitos Especiales -->
        <div class="profile-card-pro full-width" *ngIf="selectedClientProfile.specialRequirements">
          <div class="card-header-pro">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <line x1="12" y1="16" x2="12" y2="12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <line x1="12" y1="8" x2="12.01" y2="8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <h3>Requisitos Especiales</h3>
          </div>
          <div class="card-content-pro">
            <p class="description-text">{{ selectedClientProfile.specialRequirements }}</p>
          </div>
        </div>

        <!-- Tercera fila: Información Adicional -->
        <div class="profile-card-pro full-width">
          <div class="card-header-pro">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <rect x="3" y="4" width="18" height="18" rx="2" ry="2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <line x1="16" y1="2" x2="16" y2="6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <line x1="8" y1="2" x2="8" y2="6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <line x1="3" y1="10" x2="21" y2="10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <h3>Historial</h3>
          </div>
          <div class="card-content-pro">
            <div class="history-grid">
              <div class="history-item">
                <span class="history-label">Cliente desde</span>
                <span class="history-value">{{ formatDate(selectedClientProfile.createdAt) }}</span>
              </div>
              <div class="history-item">
                <span class="history-label">Última actividad</span>
                <span class="history-value">{{ selectedClientProfile.lastLogin ? formatDate(selectedClientProfile.lastLogin) : 'Sin actividad' }}</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Footer del modal -->
      <div class="client-profile-footer-pro">
      </div>
    </div>
  </div>

  <!-- Modal para ver perfil de nanny (ADMIN) - DISEÑO PROFESIONAL -->
  <div *ngIf="showNannyProfileModal" class="modal-overlay professional-overlay" (click)="closeNannyProfileModal()">
    <div class="modal-container nanny-profile-modal-pro" (click)="$event.stopPropagation()">
      <!-- Header con gradiente y datos principales -->
      <div class="nanny-profile-header-pro">
        <div class="header-gradient-pro"></div>
        <div class="header-content-pro" *ngIf="selectedNannyProfile">
          <div class="avatar-section-pro">
            <div class="avatar-large-pro">
              {{ (selectedNannyProfile.first_name || 'N')[0] }}<span>{{ (selectedNannyProfile.last_name || 'N')[0] }}</span>
            </div>
          </div>
          <div class="header-info-pro">
            <h2>{{ selectedNannyProfile.first_name }} {{ selectedNannyProfile.last_name }}</h2>
            <p class="nanny-role">Cuidadora Profesional</p>
            <div class="quick-status-pro">
              <span class="status-pill" [class.active]="selectedNannyProfile.status === 'active'">
                {{ selectedNannyProfile.status === 'active' ? 'Activa' : 'Inactiva' }}
              </span>
              <span class="status-pill verified" *ngIf="selectedNannyProfile.is_verified">
                Verificada
              </span>
            </div>
          </div>
        </div>
        <button class="professional-close-btn" (click)="closeNannyProfileModal()">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M18 6L6 18M6 6L18 18" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
          </svg>
        </button>
      </div>

      <!-- Contenido del modal -->
      <div class="nanny-profile-content-pro">
        <!-- Primera fila: Contacto y Experiencia -->
        <div class="profile-cards-grid">
          <!-- Tarjeta de Contacto -->
          <div class="profile-card-pro">
            <div class="card-header-pro">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
              <h3>Información de Contacto</h3>
            </div>
            <div class="card-content-pro">
              <div class="contact-item">
                <span class="contact-label">Email</span>
                <a [href]="'mailto:' + selectedNannyProfile.email" class="contact-value">
                  {{ selectedNannyProfile.email }}
                </a>
              </div>
              <div class="contact-item">
                <span class="contact-label">Teléfono</span>
                <a [href]="'tel:' + selectedNannyProfile.phone_number" class="contact-value">
                  {{ selectedNannyProfile.phone_number || 'No disponible' }}
                </a>
              </div>
              <div class="contact-item">
                <span class="contact-label">Dirección</span>
                <p class="contact-value">{{ selectedNannyProfile.address || 'No proporcionada' }}</p>
              </div>
            </div>
          </div>

          <!-- Tarjeta de Experiencia -->
          <div class="profile-card-pro">
            <div class="card-header-pro">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <circle cx="12" cy="7" r="4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
              <h3>Experiencia Profesional</h3>
            </div>
            <div class="card-content-pro">
              <div class="exp-item">
                <span class="exp-label">Años de Experiencia</span>
                <span class="exp-value">{{ selectedNannyProfile.experience_years }} años</span>
              </div>
              <div class="exp-item">
                <span class="exp-label">Tarifa Horaria</span>
                <span class="exp-value price">€{{ selectedNannyProfile.hourly_rate }}/h</span>
              </div>
            </div>
          </div>

          <!-- Tarjeta de Calificación -->
          <div class="profile-card-pro">
            <div class="card-header-pro">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <polygon points="12 2 15.09 10.26 24 10.27 17.18 16.27 20.27 24 12 18.01 3.73 24 6.82 16.27 0 10.27 8.91 10.26 12 2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
              </svg>
              <h3>Desempeño</h3>
            </div>
            <div class="card-content-pro rating-card">
              <div class="rating-display">
                <span class="rating-value">{{ selectedNannyProfile.rating_average || 'N/A' }}</span>
                <span class="rating-max">/5</span>
              </div>
              <p class="rating-reviews">({{ selectedNannyProfile.total_ratings || 0 }} calificaciones)</p>
              <div class="services-stat">
                <span class="services-count">{{ selectedNannyProfile.services_completed || 0 }}</span>
                <span class="services-label">servicios completados</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Segunda fila: Descripción -->
        <div class="profile-card-pro full-width">
          <div class="card-header-pro">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <h3>Descripción Profesional</h3>
          </div>
          <div class="card-content-pro">
            <p class="description-text">
              {{ selectedNannyProfile.description || 'Sin descripción disponible' }}
            </p>
          </div>
        </div>

        <!-- Tercera fila: Disponibilidad -->
        <div class="profile-card-pro full-width">
          <div class="card-header-pro">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <rect x="3" y="4" width="18" height="18" rx="2" ry="2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <line x1="16" y1="2" x2="16" y2="6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <line x1="8" y1="2" x2="8" y2="6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <line x1="3" y1="10" x2="21" y2="10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <h3>Estado de Disponibilidad</h3>
          </div>
          <div class="card-content-pro availability-section">
            <div class="availability-indicator" [class.available]="selectedNannyProfile.is_available">
              <div class="status-dot"></div>
              <div class="availability-text">
                <span class="availability-status">{{ selectedNannyProfile.is_available ? 'Disponible' : 'No disponible' }}</span>
                <p *ngIf="!selectedNannyProfile.is_available && selectedNannyProfile.reason" class="availability-reason">
                  {{ selectedNannyProfile.reason }}
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Footer del modal -->
      <div class="nanny-profile-footer-pro">
        <button type="button" class="btn-secondary-pro" (click)="closeNannyProfileModal()">
          Cerrar Perfil
        </button>
      </div>
    </div>
  </div>

  <!-- Modal de Resultado de Verificación - PROFESIONAL -->
  <div *ngIf="showVerificationResultModal" class="modal-overlay" (click)="closeVerificationResultModal()">
    <div class="modal-container verification-result-modal" (click)="$event.stopPropagation()">
      <!-- Header del modal -->
      <div class="result-modal-header" [class.result-success]="verificationResultData.type === 'success'" [class.result-error]="verificationResultData.type === 'error'" [class.result-rejected]="verificationResultData.action === 'rejected'">
        <div class="result-icon-container">
          <div class="result-icon" [class.icon-success]="verificationResultData.type === 'success'" [class.icon-error]="verificationResultData.type === 'error'" [class.icon-rejected]="verificationResultData.action === 'rejected'">
            <!-- Ícono de éxito -->
            <svg *ngIf="verificationResultData.type === 'success'" width="56" height="56" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z" fill="currentColor"/>
            </svg>
            <!-- Ícono de error -->
            <svg *ngIf="verificationResultData.type === 'error'" width="56" height="56" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z" fill="currentColor"/>
            </svg>
          </div>
        </div>
        <h2>{{ verificationResultData.title }}</h2>
      </div>

      <!-- Cuerpo del modal -->
      <div class="result-modal-body">
        <p class="result-message">{{ verificationResultData.message }}</p>
        
        <!-- Información adicional según la acción -->
        <div class="result-details" *ngIf="verificationResultData.action === 'approved'">
          <div class="detail-item">
            <span>El cliente podrá acceder a todos los servicios inmediatamente</span>
          </div>
        </div>

        <div class="result-details" *ngIf="verificationResultData.action === 'rejected'">
          <div class="detail-item">
            <span>El cliente recibirá una notificación con los detalles del rechazo</span>
          </div>
        </div>
      </div>

      <!-- Footer del modal -->
      <div class="result-modal-footer">
        <button type="button" class="btn-close-result" (click)="closeVerificationResultModal()">
          Cerrar
        </button>
      </div>
    </div>
  </div>
</div>