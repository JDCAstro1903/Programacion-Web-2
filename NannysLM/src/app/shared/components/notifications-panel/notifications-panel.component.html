<!-- Header -->
<div *ngIf="showHeader" style="margin-bottom: 1.5rem;">
  <h3 style="margin: 0 0 0.5rem 0; font-size: 1.25rem; color: #1f2937; font-weight: 600;">
    {{ title }}
    <span style="font-size: 0.875rem; color: #6b7280; margin-left: 0.5rem;">
      ({{ getTotalCount() }})
    </span>
  </h3>
</div>

<!-- Filtros -->
<div *ngIf="showFilters" style="display: flex; gap: 0.75rem; margin-bottom: 1rem;">
  <button 
    type="button"
    (click)="notificationsView = 'unread'"
    [style.background]="notificationsView === 'unread' ? '#e31b7e' : '#f3f4f6'"
    [style.color]="notificationsView === 'unread' ? 'white' : '#374151'"
    style="padding: 0.5rem 1rem; border: none; border-radius: 6px; cursor: pointer; font-weight: 500; transition: all 0.3s ease; font-size: 0.9375rem;">
    No Le√≠das ({{ getUnreadCount() }})
  </button>
  <button 
    type="button"
    (click)="notificationsView = 'all'"
    [style.background]="notificationsView === 'all' ? '#e31b7e' : '#f3f4f6'"
    [style.color]="notificationsView === 'all' ? 'white' : '#374151'"
    style="padding: 0.5rem 1rem; border: none; border-radius: 6px; cursor: pointer; font-weight: 500; transition: all 0.3s ease; font-size: 0.9375rem;">
    Todas ({{ getTotalCount() }})
  </button>
</div>

<!-- Estado de carga -->
<div *ngIf="isLoadingNotifications" style="text-align: center; padding: 2rem; color: #6b7280;">
  <div style="width: 50px; height: 50px; border: 4px solid #f3f3f3; border-top: 4px solid #e31b7e; border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 1rem;"></div>
  <p>Cargando notificaciones...</p>
</div>

<!-- Lista de notificaciones -->
<div *ngIf="!isLoadingNotifications" style="display: flex; flex-direction: column; gap: 0.75rem;">
  <!-- Sin notificaciones -->
  <div *ngIf="getFilteredNotifications().length === 0" 
    style="padding: 2rem; text-align: center; background: #f9fafb; border-radius: 8px; color: #6b7280;">
    <p style="margin: 0;">
      {{ notificationsView === 'unread' ? 'No hay notificaciones sin leer' : 'No hay notificaciones' }}
    </p>
  </div>

  <!-- Notificaciones -->
  <div #notificationCard
    *ngFor="let notification of getFilteredNotifications()" 
    [style.opacity]="notification.is_read ? '0.7' : '1'"
    style="padding: 1rem; border: 1px solid #e5e7eb; border-radius: 8px; background: white; cursor: pointer; transition: all 0.3s ease; border-left: 4px solid;"
    [style.border-left-color]="getNotificationColor(notification.type)"
    (click)="handleNotificationClick(notification)"
    (mouseenter)="onNotificationMouseEnter(notificationCard)"
    (mouseleave)="onNotificationMouseLeave(notificationCard)">
    
    <div style="display: flex; justify-content: space-between; align-items: start; gap: 1rem;">
      <div style="flex: 1; min-width: 0;">
        <!-- T√≠tulo -->
        <h4 style="margin: 0 0 0.25rem 0; font-size: 1rem; color: #1f2937; font-weight: 600;">
          {{ notification.title }}
        </h4>
        
        <!-- Mensaje -->
        <p style="margin: 0 0 0.5rem 0; color: #4b5563; font-size: 0.9375rem; line-height: 1.4;">
          {{ notification.message }}
        </p>
        
        <!-- Fecha y estado -->
        <div style="display: flex; justify-content: space-between; align-items: center; font-size: 0.8125rem; color: #9ca3af;">
          <span>{{ formatDate(notification.created_at) }}</span>
          <span *ngIf="!notification.is_read" 
            style="display: inline-block; width: 8px; height: 8px; background: #e31b7e; border-radius: 50%; margin-left: 0.5rem;" 
            title="No le√≠da"></span>
        </div>
      </div>

      <!-- Botones de acci√≥n -->
      <div style="display: flex; gap: 0.5rem; flex-shrink: 0;">
        <button 
          *ngIf="!notification.is_read"
          type="button"
          (click)="markNotificationAsRead(notification, $event)"
          title="Marcar como le√≠da"
          style="padding: 0.375rem 0.75rem; background: #f0f9ff; color: #0369a1; border: 1px solid #bae6fd; border-radius: 6px; cursor: pointer; font-size: 0.8125rem; font-weight: 500; transition: all 0.2s ease;">
          ‚úì Leer
        </button>
        <button 
          type="button"
          (click)="deleteNotification(notification.id, $event)"
          title="Eliminar"
          style="padding: 0.375rem 0.75rem; background: #fee2e2; color: #dc2626; border: 1px solid #fecaca; border-radius: 6px; cursor: pointer; font-size: 0.8125rem; font-weight: 500; transition: all 0.2s ease;">
          üóëÔ∏è
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Estilos globales -->
<style>
  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }
</style>
